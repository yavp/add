/** usage **
ROUTER.init({callback: function(addr){alert(addr)} });
ROUTER.init({
    mode: 'history',
    bindAnchors: true,
    callback: function(path){ document.querySelector('#msg').innerHTML += path+'<br>' }
});
/**/
var ROUTER={mode:"hash",activated:!1,bindAnchors:!1,initCallback:!0,path:"",root:null,callback:function(t){console.log(t)},init:function(t){if(this.activated)return this.path="",this.check(),!1;if(this.activated=!0,t)for(var i in t)this[i]=t[i];if(this.mode="history"==this.mode&&history.pushState?"history":"hash","history"==this.mode&&(this.root=location.pathname,this.root="/"!=this.root?"/"+this.clearSlashes(location.pathname)+"/":"/",this.bindAnchors)){var e=this,a=function(t){var i=t.target;if("a"===i.tagName.toLowerCase()){var a=i.getAttribute("href");if(a&&/^(?!http).*/.test(a))return e["goto"](a),t.preventDefault(),!1}};window.addEventListener?document.addEventListener("click",a,!1):window.attachEvent&&document.attachEvent("click",a)}this.listen(),this.initCallback&&""==this.path&&this.callback(this.path)},check:function(){this.path!==this.getFragment()&&(this.path=this.getFragment(),this.callback(this.path))},listen:function(){var t=this;switch(this.mode){case"history":!function(t){var i=t.pushState;t.pushState=function(e){return"function"==typeof t.onpushstate&&t.onpushstate({state:e}),i.apply(t,arguments)}}(window.history),window.onpopstate=history.onpushstate=function(){setTimeout(function(){t.check()},10)},this.check();break;case"hash":"onhashchange"in window?(window.addEventListener?window.addEventListener("hashchange",function(){t.check()},!1):window.attachEvent&&window.attachEvent("onhashchange",function(){t.check()}),this.check()):(clearInterval(this.interval),this.interval=setInterval(function(){t.check()},100))}},"goto":function(t){t=t||"","history"===this.mode?history.state!==t&&history.pushState(t,null,this.root+t):window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+t},getFragment:function(){var t="";if("history"===this.mode)t=this.clearSlashes(decodeURI(location.pathname)),t=t.replace(this.clearSlashes(this.root),""),t=this.clearSlashes(t);else{var i=window.location.href.match(/#(.*)$/);t=i?i[1]:""}return t},clearSlashes:function(t){return t.toString().replace(/\/$/,"").replace(/^\//,"")}};